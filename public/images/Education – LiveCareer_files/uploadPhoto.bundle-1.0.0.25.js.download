(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{586:function(e,t,o){"use strict";o.r(t),o.d(t,"mapDispatchToProps",(function(){return de}));var a=o(0),r=o.n(a),n=o(24),i=o(16),s=o(31),c=o(52),p=o(62),l=o(1),u=o(5),h=o(596),d=o(22),m=o.n(d),g=o(41),f=o(42),b=o(4),y=o.n(b),v=o(17),w=o.n(v);function P(e,t){return new Promise((function(o,a){var r,n=new Image;n.onload=function(){return o(n)},n.onerror=a,!1==(null!==(r=e)&&!!r.match(/^\s*data:([a-z]+\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\-._~:@/?%\s]*\s*$/i))&&t&&(n.crossOrigin=t),n.src=e}))}var O=["scale","resize","rotate","image","shape","border","borderRadius","width","height","position","color","style","rectObj","crossOrigin","cropperDimension","cropperPosition","onLoadFailure","onLoadSuccess","onImageReady","onImageChange","onMouseUp","onMouseMove","onPositionChange","disableBoundaryChecks"];function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(){return(C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}function M(e,t){if(null==e)return{};var o,a,r=function(e,t){if(null==e)return{};var o,a,r={},n=Object.keys(e);for(a=0;a<n.length;a++)o=n[a],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)o=n[a],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a,r,n,i,s=[],c=!0,p=!1;try{if(n=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;c=!1}else for(;!(c=(a=n.call(o)).done)&&(s.push(a.value),s.length!==t);c=!0);}catch(e){p=!0,r=e}finally{try{if(!c&&null!=o.return&&(i=o.return(),Object(i)!==i))return}finally{if(p)throw r}}return s}}(e,t)||D(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){if(e){if("string"==typeof e)return R(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?R(e,t):void 0}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,a=new Array(t);o<t;o++)a[o]=e[o];return a}function S(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}function E(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?S(Object(o),!0).forEach((function(t){_(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):S(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,V(a.key),a)}}function L(e,t){return(L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,a=z(e);if(t){var r=z(this).constructor;o=Reflect.construct(a,arguments,r)}else o=a.apply(this,arguments);return N(this,o)}}function N(e,t){if(t&&("object"===x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return T(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t,o){return(t=V(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function V(e){var t=function(e,t){if("object"!==x(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var a=o.call(e,t||"default");if("object"!==x(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===x(t)?t:String(t)}var B,A=!("undefined"==typeof window||"undefined"==typeof navigator||!("ontouchstart"in window||navigator.msMaxTouchPoints>0)),H="undefined"!=typeof File,F=!1,q=!1,X=!1,Y=!1,Z=!1,W={touch:{react:{down:"onTouchStart",mouseDown:"onMouseDown",drag:"onTouchMove",move:"onTouchMove",mouseMove:"onMouseMove",up:"onTouchEnd",mouseUp:"onMouseUp"},native:{down:"touchstart",mouseDown:"mousedown",drag:"touchmove",move:"touchmove",mouseMove:"mousemove",up:"touchend",mouseUp:"mouseup"}},desktop:{react:{down:"onMouseDown",drag:"onDragOver",move:"onMouseMove",up:"onMouseUp"},native:{down:"mousedown",drag:"dragStart",move:"mousemove",up:"mouseup"}}},J=A?W.touch:W.desktop,$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t)}(i,e);var t,o,a,n=U(i);function i(){var e;k(this,i);for(var t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return _(T(e=n.call.apply(n,[this].concat(o))),"state",{drag:!1,my:null,mx:null,image:{x:.5,y:.5},color:e.props.color,dragObj:"image",cropperPosition:e.props.cropperPosition,resize:!1,cropperDimension:e.props.cropperDimension,borderRadius:"circle"==e.props.shape&&0==e.props.borderRadius?50:e.props.borderRadius}),_(T(e),"drawRoundedRect",(function(t,o,a,r,n,i){"circle"!=e.props.shape?t.rect(o,a,r,n):t.arc(o,a,i,0,2*Math.PI)})),_(T(e),"handleImageReady",(function(t){var o=e.getInitialSize(t.width,t.height);o.resource=t,o.x=.5,o.y=.5,e.setState({drag:!1,image:o},e.props.onImageReady),e.props.onLoadSuccess(o)})),_(T(e),"clearImage",(function(){var t=e.canvas;t.getContext("2d").clearRect(0,0,t.width,t.height)})),_(T(e),"collides",(function(t,o){var a=!1;if("circle"!=e.props.shape){var r=t.x,n=t.x+t.w,i=t.y,s=t.y+t.h;n>=o.offsetX&&r<=o.offsetX&&s>=o.offsetY&&i<=o.offsetY&&(a=!0)}else Math.sqrt(Math.pow(o.offsetX-t.x,2)+Math.pow(o.offsetY-t.y,2))<e.state.borderRadius&&(a=!0);return a})),_(T(e),"handleMouseDown",(function(t){(t=t||window.event).preventDefault();var o=e.collides(e.props.rectObj,t.nativeEvent);"circle"!=e.props.shape?e.checkCropperHandler(t.nativeEvent,e.props.rectObj.x,e.props.rectObj.y)?F=!0:e.checkCropperHandler(t.nativeEvent,e.props.rectObj.x+e.props.rectObj.w,e.props.rectObj.y)?q=!0:e.checkCropperHandler(t.nativeEvent,e.props.rectObj.x,e.props.rectObj.y+e.props.rectObj.h)?X=!0:e.checkCropperHandler(t.nativeEvent,e.props.rectObj.x+e.props.rectObj.w,e.props.rectObj.y+e.props.rectObj.h)&&(Y=!0):e.checkCropperHandler(t.nativeEvent,e.props.rectObj.x+e.state.borderRadius,e.props.rectObj.y)&&(Z=!0),F||q||X||Y||Z?e.setState({resize:!0}):e.setState({drag:!0,mx:null,my:null,dragObj:o?"cropper":"image"})})),_(T(e),"checkCircle",(function(t,o){return Math.sqrt(Math.pow(t.offsetX-(o.x+e.state.borderRadius),2)+Math.pow(t.offsetY-o.y,2))<5})),_(T(e),"checkCropperHandler",(function(e,t,o){return Math.sqrt(Math.pow(e.offsetX-t,2)+Math.pow(e.offsetY-o,2))<5})),_(T(e),"handleMouseUp",(function(){e.state.drag?(e.setState({drag:!1}),e.props.onMouseUp()):e.state.resize&&(F=!1,q=!1,X=!1,Y=!1,Z=!1,e.setState({resize:!1}),e.props.onMouseUp())})),_(T(e),"handleMouseMove",(function(t){if(t=t||window.event,e.state.drag)if("image"==e.state.dragObj){var o=t.targetTouches?t.targetTouches[0].pageX:t.clientX,a=t.targetTouches?t.targetTouches[0].pageY:t.clientY,r={mx:o,my:a},n=e.props.rotate;if(n=(n%=360)<0?n+360:n,e.state.mx&&e.state.my){var i=e.state.mx-o,s=e.state.my-a,c=e.state.image.width*e.props.scale,p=e.state.image.height*e.props.scale,l=e.getCroppingRect(),u=l.x,h=l.y;u*=c,h*=p;var d=function(e){return e*(Math.PI/180)},m=Math.cos(d(n)),g=Math.sin(d(n)),f=h+-i*g+s*m,b={x:(u+i*m+s*g)/c+1/e.props.scale*e.getXScale()/2,y:f/p+1/e.props.scale*e.getYScale()/2};e.props.onPositionChange(b),r.image=E(E({},e.state.image),b)}e.setState(r),e.props.onMouseMove(t)}else{var y=t.targetTouches?t.targetTouches[0].pageX:t.clientX,v=t.targetTouches?t.targetTouches[0].pageY:t.clientY,w={mx:y,my:v,cropperPosition:e.state.cropperPosition},P=e.getDimensions();if(e.state.mx&&e.state.my){var O=e.state.mx-y,x=e.state.my-v;"circle"!=e.props.shape?e.props.rectObj.x>=2&&e.props.rectObj.y>=2&&e.props.rectObj.x+e.props.rectObj.w<P.width&&e.props.rectObj.y+e.props.rectObj.h<P.height?(w.cropperPosition[0]-=O,w.cropperPosition[1]-=x):(w.cropperPosition[0]=w.cropperPosition[0]<2?2:w.cropperPosition[0],w.cropperPosition[1]=w.cropperPosition[1]<2?2:w.cropperPosition[1],w.cropperPosition[0]=e.props.rectObj.x+e.props.rectObj.w>=P.width?P.width-e.props.rectObj.w-1:w.cropperPosition[0],w.cropperPosition[1]=e.props.rectObj.y+e.props.rectObj.h>=P.height?P.height-e.props.rectObj.h-1:w.cropperPosition[1]):w.cropperPosition[0]-e.state.borderRadius<0?w.cropperPosition[0]=e.state.borderRadius+1:w.cropperPosition[1]-e.state.borderRadius<0?w.cropperPosition[1]=e.state.borderRadius+1:w.cropperPosition[0]+e.state.borderRadius>e.props.width-5?w.cropperPosition[0]=w.cropperPosition[0]-1:w.cropperPosition[1]+e.state.borderRadius>e.props.height?w.cropperPosition[1]=w.cropperPosition[1]-1:(w.cropperPosition[0]-=O,w.cropperPosition[1]-=x)}e.setState(w)}else if(e.state.resize){var C={mx:t.targetTouches?t.targetTouches[0].pageX:t.offsetX,my:t.targetTouches?t.targetTouches[0].pageY:t.offsetY,cropperPosition:e.state.cropperPosition,cropperDimension:e.state.cropperDimension,borderRadius:e.state.borderRadius};"square"==e.props.shape?e.squareResize(C):"rect"==e.props.shape?e.rectResize(C):"circle"==e.props.shape&&e.circleResize(C),e.setState(C)}})),_(T(e),"circleResize",(function(t){e.checkForBoundation(t)&&(t.borderRadius=Math.abs(t.cropperPosition[0]-t.mx))})),_(T(e),"rectResize",(function(t){e.checkRectBoundation(t)&&(F?(t.cropperDimension[0]+=t.cropperPosition[0]-t.mx,t.cropperDimension[1]+=t.cropperPosition[1]-t.my,t.cropperPosition[0]=t.mx,t.cropperPosition[1]=t.my):q?(t.cropperDimension[0]=Math.abs(t.cropperPosition[0]-t.mx),t.cropperDimension[1]+=t.cropperPosition[1]-t.my,t.cropperPosition[1]=t.my):X?(t.cropperDimension[0]+=t.cropperPosition[0]-t.mx,t.cropperDimension[1]=Math.abs(t.cropperPosition[1]-t.my),t.cropperPosition[0]=t.mx):Y&&(t.cropperDimension[0]=Math.abs(t.cropperPosition[0]-t.mx),t.cropperDimension[1]=Math.abs(t.cropperPosition[1]-t.my)))})),_(T(e),"squareResize",(function(t){if(e.checkRectBoundation(t))return F?(t.cropperDimension[0]+=t.cropperPosition[0]-t.mx,t.cropperDimension[1]+=t.cropperPosition[0]-t.mx,t.cropperPosition[0]=t.mx,t.cropperPosition[1]=t.mx):q?(t.cropperDimension[0]+=t.cropperPosition[1]-t.my,t.cropperDimension[1]+=t.cropperPosition[1]-t.my,t.cropperPosition[1]=t.my):X?(t.cropperDimension[0]+=t.cropperPosition[0]-t.mx,t.cropperDimension[1]+=t.cropperPosition[0]-t.mx,t.cropperPosition[0]=t.mx):Y&&(t.cropperDimension[0]=Math.abs(t.cropperPosition[0]-t.mx),t.cropperDimension[1]=Math.abs(t.cropperPosition[0]-t.mx)),t})),_(T(e),"checkRectBoundation",(function(t){return t.mx>5&&t.my>5&&t.mx<e.props.width-5&&t.my<e.props.height-5})),_(T(e),"checkForBoundation",(function(t){return t.cropperPosition[0]-Math.abs(t.cropperPosition[0]-t.mx)>0&&t.cropperPosition[1]-Math.abs(t.cropperPosition[0]-t.mx)>0&&t.cropperPosition[0]+Math.abs(t.cropperPosition[0]-t.mx)<e.props.width-5&&t.cropperPosition[1]+Math.abs(t.cropperPosition[0]-t.mx)<e.props.height})),_(T(e),"setCanvas",(function(t){e.canvas=t})),e}return t=i,(o=[{key:"componentDidMount",value:function(){var e=w.a.findDOMNode(this.canvas).getContext("2d");if(this.props.image&&this.loadImage(this.props.image),this.paint(e),document){var t=J.native;document.addEventListener(t.move,this.handleMouseMove,!1),document.addEventListener(t.up,this.handleMouseUp,!1),A&&(document.addEventListener(t.mouseMove,this.handleMouseMove,!1),document.addEventListener(t.mouseUp,this.handleMouseUp,!1))}}},{key:"componentWillReceiveProps",value:function(e){e.image&&this.props.image!==e.image||this.props.width!==e.width||this.props.height!==e.height?this.loadImage(e.image):e.image||this.clearImage()}},{key:"componentDidUpdate",value:function(e,t){var o=w.a.findDOMNode(this.canvas),a=o.getContext("2d");a.clearRect(0,0,o.width,o.height),this.paint(a),this.paintImage(a,this.state.image,this.props.border),e.image===this.props.image&&e.width===this.props.width&&e.height===this.props.height&&e.position===this.props.position&&e.scale===this.props.scale&&e.rotate===this.props.rotate&&t.my===this.state.my&&t.mx===this.state.mx&&t.image.x===this.state.image.x&&t.image.y===this.state.image.y||this.props.onImageChange()}},{key:"componentWillUnmount",value:function(){if(document){var e=J.native;document.removeEventListener(e.move,this.handleMouseMove,!1),document.removeEventListener(e.up,this.handleMouseUp,!1),A&&(document.removeEventListener(e.mouseMove,this.handleMouseMove,!1),document.removeEventListener(e.mouseUp,this.handleMouseUp,!1))}}},{key:"isVertical",value:function(){return this.props.rotate%180!=0}},{key:"getBorders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.border;return Array.isArray(e)?e:[e,e]}},{key:"getDimensions",value:function(){var e=this.props,t=e.width,o=e.height,a=e.rotate,r=e.border,n={},i=t,s=o;return this.isVertical()?(n.width=s,n.height=i):(n.width=i,n.height=s),{canvas:n,rotate:a,width:t,height:o,border:r}}},{key:"trimCanvas",value:function(e){var t,o,a,r=e.getContext("2d"),n=document.createElement("canvas").getContext("2d"),i=r.getImageData(0,0,e.width,e.height),s=i.data.length,c={top:null,left:null,right:null,bottom:null};for(t=0;t<s;t+=4)0!==i.data[t+3]&&(o=t/4%e.width,a=~~(t/4/e.width),null===c.top&&(c.top=a),(null===c.left||o<c.left)&&(c.left=o),(null===c.right||c.right<o)&&(c.right=o),(null===c.bottom||c.bottom<a)&&(c.bottom=a));var p=c.bottom-c.top,l=c.right-c.left,u=r.getImageData(c.left,c.top,l,p);return n.canvas.width=l,n.canvas.height=p,n.putImageData(u,0,0),n.canvas}},{key:"getCroppedImage",value:function(){var e=this,t=w.a.findDOMNode(this.canvas).getContext("2d"),o="";return new Promise((function(a,r){var n=e.props.color;e.setState({color:[n[0],n[1],n[2],0]},(function(){o="circle"==e.props.shape?t.getImageData(e.state.cropperPosition[0]-e.state.borderRadius,e.state.cropperPosition[1]-e.state.borderRadius,2*e.state.borderRadius,2*e.state.borderRadius):t.getImageData(e.state.cropperPosition[0],e.state.cropperPosition[1],e.state.cropperDimension[0],e.state.cropperDimension[1]);var r=document.createElement("canvas");r.width="circle"==e.props.shape?2*e.state.borderRadius:e.state.cropperDimension[0],r.height="circle"==e.props.shape?2*e.state.borderRadius:e.state.cropperDimension[1],r.getContext("2d").putImageData(o,0,0),e.setState({color:n}),e.props.enablePhotoUploadZoomOut&&(r=e.trimCanvas(r)),a(r)}))}))}},{key:"getImage",value:function(){var e=this.getCroppingRect(),t=this.state.image;e.x*=t.resource.width,e.y*=t.resource.height,e.width*=t.resource.width,e.height*=t.resource.height;var o=document.createElement("canvas");this.isVertical()?(o.width=e.height,o.height=e.width):(o.width=e.width,o.height=e.height);var a=o.getContext("2d");return a.translate(o.width/2,o.height/2),a.rotate(this.props.rotate*Math.PI/180),a.translate(-o.width/2,-o.height/2),this.isVertical()&&a.translate((o.width-o.height)/2,(o.height-o.width)/2),a.drawImage(t.resource,-e.x,-e.y),o}},{key:"getImageScaledToCanvas",value:function(){var e=this.getDimensions(),t=e.width,o=e.height,a=document.createElement("canvas");return this.isVertical()?(a.width=o,a.height=t):(a.width=t,a.height=o),this.paintImage(a.getContext("2d"),this.state.image,0,1),a}},{key:"getXScale",value:function(){var e=this.props.width/this.props.height,t=this.state.image.width/this.state.image.height;return Math.min(1,e/t)}},{key:"getYScale",value:function(){var e=this.props.height/this.props.width,t=this.state.image.height/this.state.image.width;return Math.min(1,e/t)}},{key:"getCroppingRect",value:function(){var e=this.props.position||{x:this.state.image.x,y:this.state.image.y},t=1/this.props.scale*this.getXScale(),o=1/this.props.scale*this.getYScale(),a={x:e.x-t/2,y:e.y-o/2,width:t,height:o},r=0,n=1-a.width,i=0,s=1-a.height;return(this.props.disableBoundaryChecks||t>1||o>1)&&(r=-a.width,n=1,i=-a.height,s=1),E(E({},a),{},{x:Math.max(r,Math.min(a.x,n)),y:Math.max(i,Math.min(a.y,s))})}},{key:"loadImage",value:function(e){var t;H&&e instanceof File?(t=e,new Promise((function(e,o){var a=new FileReader;a.onload=function(t){try{var a=P(t.target.result);e(a)}catch(e){o(e)}},a.readAsDataURL(t)}))).then(this.handleImageReady).catch(this.props.onLoadFailure):"string"==typeof e&&P(e,this.props.crossOrigin).then(this.handleImageReady).catch(this.props.onLoadFailure)}},{key:"getInitialSize",value:function(e,t){var o,a,r=this.getDimensions();return r.height/r.width>t/e?a=e*((o=this.getDimensions().height)/t):o=t*((a=this.getDimensions().width)/e),{height:o,width:a}}},{key:"drawCropperHandle",value:function(e,t,o){e.save(),e.beginPath(),e.fillStyle="white",e.globalAlpha=1,0==this.state.color[3]&&(e.globalAlpha=0),e.arc(t,o,5,0,2*Math.PI),e.fill(),e.restore()}},{key:"paintImage",value:function(e,t,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(t.resource){var r=this.calculatePosition(t,o);e.save(),e.translate(e.canvas.width/2,e.canvas.height/2),e.rotate(this.props.rotate*Math.PI/180),e.translate(-e.canvas.width/2,-e.canvas.height/2),this.isVertical()&&e.translate((e.canvas.width-e.canvas.height)/2,(e.canvas.height-e.canvas.width)/2),e.scale(a,a),e.globalCompositeOperation="destination-over",e.drawImage(t.resource,r.x,r.y,r.width,r.height),e.restore()}}},{key:"calculatePosition",value:function(e,t){e=e||this.state.image;var o=j(this.getBorders(t),2),a=o[0],r=o[1],n=this.getCroppingRect(),i=e.width*this.props.scale,s=e.height*this.props.scale,c=-n.x*i,p=-n.y*s;return this.isVertical()?(c+=r,p+=a):(c+=a,p+=r),{x:c,y:p,height:s,width:i}}},{key:"paint",value:function(e){e.save(),e.scale(1,1),e.translate(0,0);var t=this.state.color;"string"==typeof t&&(t=JSON.parse(t)),e.fillStyle="rgba("+t.slice(0,4).join(",")+")";var o=this.state.borderRadius,a=this.getDimensions(),r=j(this.getBorders(a.border),2),n=r[0],i=r[1],s=a.canvas.height,c=a.canvas.width;o=Math.max(o,0),o=Math.min(o,c/2-n,s/2-i),e.beginPath(),this.props.rectObj.x=this.state.cropperPosition[0],this.props.rectObj.y=this.state.cropperPosition[1],this.props.rectObj.w=this.state.cropperDimension[0],this.props.rectObj.h=this.state.cropperDimension[1],e.save(),this.drawRoundedRect(e,this.props.rectObj.x,this.props.rectObj.y,this.props.rectObj.w,this.props.rectObj.h,o),e.restore(),e.rect(c,0,-c,s),e.fill("evenodd"),e.restore(),"string"!=typeof this.state.color&&this.drawHandle(e,this.props.rectObj,o)}},{key:"drawHandle",value:function(e,t,o){"circle"!=this.props.shape?(this.drawCropperHandle(e,t.x,t.y),this.drawCropperHandle(e,t.x,t.y+t.h),this.drawCropperHandle(e,t.x+t.w,t.y),this.drawCropperHandle(e,t.x+t.w,t.y+t.h)):this.drawCropperHandle(e,t.x+o,t.y)}},{key:"render",value:function(){var e=this.props,t=(e.scale,e.resize,e.rotate,e.image,e.shape,e.border,e.borderRadius,e.width,e.height,e.position,e.color,e.style),o=(e.rectObj,e.crossOrigin,e.cropperDimension,e.cropperPosition,e.onLoadFailure,e.onLoadSuccess,e.onImageReady,e.onImageChange,e.onMouseUp,e.onMouseMove,e.onPositionChange,e.disableBoundaryChecks,M(e,O)),a=this.getDimensions(),n={width:a.canvas.width,height:a.canvas.height,cursor:this.state.drag?"grabbing":this.state.resize?"col-resize":"grab",touchAction:"none"},i={width:1*a.canvas.width,height:1*a.canvas.height,style:E(E({},n),t)};return i[J.react.down]=this.handleMouseDown,A&&(i[J.react.mouseDown]=this.handleMouseDown),r.a.createElement("canvas",C({ref:this.setCanvas},i,o))}}])&&I(t.prototype,o),a&&I(t,a),Object.defineProperty(t,"prototype",{writable:!1}),i}(r.a.Component);_($,"propTypes",{scale:y.a.number,rotate:y.a.number,image:y.a.oneOfType([y.a.string].concat((B=H?[y.a.instanceOf(File)]:[],function(e){if(Array.isArray(e))return R(e)}(B)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(B)||D(B)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))),border:y.a.oneOfType([y.a.number,y.a.arrayOf(y.a.number)]),borderRadius:y.a.number,width:y.a.number,height:y.a.number,position:y.a.shape({x:y.a.number,y:y.a.number}),color:y.a.arrayOf(y.a.number),style:y.a.object,crossOrigin:y.a.oneOf(["","anonymous","use-credentials"]),className:y.a.string,onLoadFailure:y.a.func,onLoadSuccess:y.a.func,onImageReady:y.a.func,onImageChange:y.a.func,onMouseUp:y.a.func,onMouseMove:y.a.func,onPositionChange:y.a.func,disableBoundaryChecks:y.a.bool}),_($,"defaultProps",{disableBoundaryChecks:!1,scale:1,rotate:0,border:0,borderRadius:50,width:200,height:200,cropperDimension:[50,50],color:[0,0,0,.5],style:{},className:"",rectObj:{},shape:"square",enablePhotoUploadZoomOut:!1,onLoadFailure:function(){},onLoadSuccess:function(){},onImageReady:function(){},onImageChange:function(){},onMouseUp:function(){},onMouseMove:function(){},onPositionChange:function(){}});var G=$,K=o(32),Q=o(56);function ee(e){var t=RDL.Localization,o=e.getShape(),a=r.a.createElement("section",{className:"modal-section"},e.uploadedImage&&r.a.createElement("div",{className:"modal-section-header px-5"},r.a.createElement("div",{className:"photo-title-update clearfix"},r.a.createElement("label",{className:"label-new-photo btn-link float-right"},r.a.createElement("input",{type:"file",name:"myImage2",ref:function(t){e.assignRef("fileUploaded",t)},accept:".png,.gif,.jpg",placeholder:"Image",className:"input-image",onChange:e.handleChange}),t.choosePhoto_Text))),r.a.createElement("div",{className:e.uploadedImage?"modal-section-body px-5 pb-5":"modal-section-body p-5"},r.a.createElement("div",{className:"upload-image-canvas "},r.a.createElement("div",{className:e.uploadedImage?"upload-image-input d-none":"upload-image-input"},r.a.createElement("div",{className:"upload-icon text-center"},r.a.createElement("img",{className:"logo-image mb-2",src:window.RDL.Paths.ImageBasePath+"upload_icon.png"})),r.a.createElement("label",{className:"sprite-upload-image icon-camera"},r.a.createElement("input",{type:"file",name:"myImage",ref:function(t){e.assignRef("fileUpload",t)},accept:".png,.gif,.jpg",placeholder:"Image",className:"input-image mr-4",onChange:e.handleChange}),r.a.createElement("span",{className:"btn btn-primary upload-image-text-input link"},t.uploadPhoto_Label))),r.a.createElement("div",{className:"upload-image-area text-center"},e.uploadedImage&&r.a.createElement(G,{ref:function(t){e.assignRef("editor",t)},image:e.uploadedImage,width:237,height:343,borderRadius:75,cropperPosition:[75,75],shape:o,cropperDimension:[Q.b[o].width,Q.b[o].height],color:[245,245,245,.8],scale:e.zoomValue,enablePhotoUploadZoomOut:e.enablePhotoUploadZoomOut,rotate:0,crossOrigin:"anonymous"}))),r.a.createElement("span",{className:"image-validation-text text-red d-none"},t.uploadValidFile_Text),r.a.createElement("span",{className:"image-size-text text-red d-none"},t.fileLargeValidation_Text),r.a.createElement("div",{className:"modal-section-footer mt-5"},r.a.createElement("button",{type:"button",className:"btn btn-secondary ",onClick:e.closePhotoUploadModal},RDL.Localization.btnBack),r.a.createElement("button",{type:"button",onClick:e.processImage,className:e.uploadedImage?"btn btn-primary":"btn btn-primary d-none"},t.resumePhoto_Text),e.uploadedImage&&r.a.createElement("div",{className:"image-zoom-in-out float-right mt-3"},r.a.createElement("span",{className:"sprite-upload-image icon-zoom-out mr-2"}),r.a.createElement("input",{type:"range",min:e.trimCanvasClasses.min?e.trimCanvasClasses.min:1,max:e.trimCanvasClasses.max?e.trimCanvasClasses.max:10,step:e.trimCanvasClasses.step?e.trimCanvasClasses.step:.2,name:"scale",value:e.zoomValue,onChange:e.handleZoom}),r.a.createElement("span",{className:"sprite-upload-image icon-zoom-in ml-2"})))));return r.a.createElement("div",{className:"page-main sticky upload-photo"},r.a.createElement(g.a,null),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"jumbotron"},r.a.createElement("section",{className:"jobstatus-container"},r.a.createElement("div",{className:"container p-0"},r.a.createElement("div",{className:"row mt-5"},r.a.createElement("div",{className:"col-12"},r.a.createElement(f.a,{updateVisitedIndex:e.updateVisitedIndex,pageCode:"photoUpload",isProgressBar:!1,hidePreviewTipSection:!0,section:"photoUpload"})),r.a.createElement("div",{className:"col-7"},r.a.createElement("div",{className:"row p-0 m-0"},r.a.createElement("div",{className:"col-4 pl-0"},r.a.createElement("div",{className:"upload-image-wrap float-left text-center"},r.a.createElement("span",{className:"upload-image",onClick:e.openPhotoUploadModal},r.a.createElement("img",{className:o,id:"uploadimage",src:e.imageURL})),r.a.createElement("span",{className:"btn btn-outline-primary upload-input link mt-4",onClick:e.openPhotoUploadModal},e.uploadedImage?t.changePhoto_Label:t.uploadPhoto_Label))),r.a.createElement("div",{className:"col-8 pl-0"},r.a.createElement("div",{className:"photo-tips-wrap float-left"},r.a.createElement("h6",null,t.photoTips_Text),r.a.createElement("ul",{className:"list-square px-0"},r.a.createElement("li",{dangerouslySetInnerHTML:{__html:t.finalPhoto_Text}}),r.a.createElement("li",{dangerouslySetInnerHTML:{__html:t.PhoneLength_Text}}),r.a.createElement("li",{dangerouslySetInnerHTML:{__html:t.accepyableFormats_Text}})))))),r.a.createElement("div",{className:"col-5"},r.a.createElement(K.a,{document:e.document,scaleVal:e.scaleVal,isThumbPreviewLarg:!0,isThumbPreview:!0,skipDocumentScaling:RDL.SkipLargeThumbnailScaling})),r.a.createElement("div",{className:"col-12 mt-3"},r.a.createElement("div",{className:"page-action d-flex mt-3"},r.a.createElement("button",{className:"btn btn-secondary",type:"button",onClick:e.onBackClick},RDL.Localization.btnBack),r.a.createElement("button",{className:"btn btn-primary btn-lg",type:"button",onClick:e.onBackClick},RDL.Localization.btnContinue)))))))),r.a.createElement(m.a,{title:t.photoUpload_Text,isOpen:e.isPhotoUploadModalOpen,closeModal:e.closePhotoUploadModal,onPrimaryClick:e.uploadPhoto,onCancelClick:e.closePhotoUploadModal,btnPrimaryLabel:t.resumePhoto_Text,btnCancelLabel:t.cancel_Label,hideHeader:!0,hideFooter:!1,cssClass:{modalDialog:"modal modal-lg modal-upload-photo",btnPrimary:"btn-primary",btnCancel:"btn-default",modalFooter:"justify-content-center d-none",overlayClassName:RDL.joshuaTreeINTL?" overflow-auto":" show-dashboard-overlay"}},a))}
// EXTERNAL MODULE: ./node_modules/@license-admin/helper/build/index.js
var te=o(2),oe=o(3);function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,ue(a.key),a)}}function ne(e,t){return(ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,a=pe(e);if(t){var r=pe(this).constructor;o=Reflect.construct(a,arguments,r)}else o=a.apply(this,arguments);return se(this,o)}}function se(e,t){if(t&&("object"===ae(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ce(e)}function ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function le(e,t,o){return(t=ue(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function ue(e){var t=function(e,t){if("object"!==ae(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var a=o.call(e,t||"default");if("object"!==ae(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ae(t)?t:String(t)}var he=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ne(e,t)}(i,e);var t,o,a,n=ie(i);function i(e,t){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),le(ce(o=n.call(this,e,t)),"scaleVal",void 0),le(ce(o),"assignRef",(function(e,t){null!=t&&(o.refs[e]=t)})),le(ce(o),"handleChange",(function(e){var t=e.target.files[0],a=document.querySelector(".image-validation-text"),r=document.querySelector(".image-size-text");return-1==["image/jpeg","image/png","image/gif"].indexOf(t.type)?(a.classList.remove("d-none"),void r.classList.add("d-none")):(a.classList.add("d-none"),t.size>4096e3?(a.classList.add("d-none"),void r.classList.remove("d-none")):(r.classList.add("d-none"),void o.setState({uploadedImage:t})))})),le(ce(o),"getShape",(function(){var e=o.props.Document.skinCD;if(RDL.files[e+".htm"]){var t=RDL.files[e+".htm"].body,a=t.querySelector("#document")||t.querySelector(".document");if(a){var r=a.classList;return r.contains("square")?"square":r.contains("circle")?"circle":"rect"}}})),le(ce(o),"openPhotoUploadModal",(function(){o.setState({isPhotoUploadModalOpen:!0})})),le(ce(o),"closePhotoUploadModal",(function(){o.setState({isPhotoUploadModalOpen:!1})})),le(ce(o),"uploadPhoto",(function(){o.setState({isPhotoUploadModalOpen:!1})})),le(ce(o),"onBackClick",(function(){o.props.history.push(u.c.FINALIZE+Object(oe.w)(o.props.Document.id))})),le(ce(o),"onSaveClick",(function(){o.setState({isPhotoUploadModalOpen:!1}),o.props.history.push(u.c.FINALIZE+Object(oe.w)(o.props.Document.id))})),le(ce(o),"processImage",(function(){o.refs.editor&&(RDL.startPageLoader(),o.refs.editor.getCroppedImage().then((function(e){o.props.documentActions.uploadPhoto(o.props.User.UserUID,e.toDataURL("image/jpeg",.9),"","","","",e.width,e.height,o.props.Document.id,RDL.countryDetails.countryCode).then((function(){o.setState({uploadsuccessfull:!0}),RDL.closePageLoader()})).catch((function(e){console.log(e)})),o.setState({isPhotoUploadModalOpen:!1})})))})),le(ce(o),"handleZoom",(function(e){o.setState({zoomValue:e.target.value}),o.refs.editor.scale=o.state.zoomValue})),le(ce(o),"isPreviewScalefactor",(function(){return window.innerWidth<=1200&&window.innerWidth>991?o.scaleVal=.625:window.innerWidth<=991?o.scaleVal=.519:o.scaleVal=.723,o.scaleVal}));var a=o.props.PhotoSection&&o.props.PhotoSection.paragraphs&&o.props.PhotoSection.paragraphs.length>0?te.FieldHelper.getCharValue(o.props.PhotoSection.paragraphs[0].docDatas,te.TypeCodes.fieldCd.PhotoURL):"";return o.state={isPhotoUploadModalOpen:!1,uploadedImage:""!=a?a+"?"+window.RDL.randomPhotoNumber:"",zoomValue:1,imageURL:""==a?Object(oe.hc)(o.props.Document.skinCD):a+"?"+window.RDL.randomPhotoNumber,uploadsuccessfull:!1},o}return t=i,(o=[{key:"componentDidMount",value:function(){RDL.closePageLoader()}},{key:"componentWillMount",value:function(){this.refs={}}},{key:"componentWillReceiveProps",value:function(e){var t=te.CommonHelper.getSectionByCD(e.Document.sections,te.TypeCodes.sectionTypeCd.NameContact),o=null!=t&&null!=t.paragraphs&&t.paragraphs.length>0?te.FieldHelper.getCharValue(t.paragraphs[0].docDatas,te.TypeCodes.fieldCd.PhotoURL):"";o&&""!=o&&this.setState({imageURL:""==o?"":o+"?"+window.RDL.randomPhotoNumber})}},{key:"render",value:function(){var e=this.isPreviewScalefactor();return r.a.createElement(ee,{assignRef:this.assignRef,isPhotoUploadModalOpen:this.state.isPhotoUploadModalOpen,uploadedImage:this.state.uploadedImage,zoomValue:this.state.zoomValue,updateVisitedIndex:!0,imageURL:this.state.imageURL,handleChange:this.handleChange,closePhotoUploadModal:this.closePhotoUploadModal,processImage:this.processImage,handleZoom:this.handleZoom,openPhotoUploadModal:this.openPhotoUploadModal,onBackClick:this.onBackClick,onSaveClick:this.onSaveClick,uploadPhoto:this.uploadPhoto,scaleVal:e,document:this.props.Document,getShape:this.getShape,enablePhotoUploadZoomOut:!0,trimCanvasClasses:l.trimCanvasClasses})}}])&&re(t.prototype,o),a&&re(t,a),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.Component);function de(e){return{documentActions:Object(i.b)(s,e),userActions:Object(i.b)(c,e),commonActions:Object(i.b)(p,e)}}t.default=Object(h.a)(Object(n.b)((function(e){var t=te.TypeCodes.sectionTypeCd.NameContact,o=e.Document,a=te.CommonHelper.getSectionByCD(o.sections,t)||{};return{Document:o,User:e.User,PhotoSection:a}}),de)(he))}}]);